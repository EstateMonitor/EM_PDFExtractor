# Документация по настройке конфигурационных файлов для описания структуры PDF-файлов

Эта документация описывает структуру конфигурационного файла, который используется для определения и извлечения данных
из PDF-документов. Конфигурационный файл описывает, как и какие данные следует извлекать из PDF-документов.

## Структура конфигурационного файла

### 1. `pdf_structure`

Основной объект конфигурационного файла, который содержит описание объектов, подлежащих извлечению.

### 2. `objects`

Содержит описание объектов, которые необходимо извлечь из PDF-документа. Каждый объект описывается как отдельный элемент
массива.

#### Поля для объекта:

- `type`: Тип объекта. **Возможные значения**:
    - `"text"`: Текстовый объект.
    - `"table"`: Табличный объект.
- `name`: Уникальное имя объекта (строка).
- `method`: Метод определения объекта. Возможные значения:
    - `"absolute"`: Объект определяется по абсолютным координатам.
    - `"by_pointers"`: Объект определяется по указателям (например, рисунки).
    - Можно добавить другие методы определения объектов в будущем.
- `offset`: Смещение относительно найденного объекта/начала координат, в зависимости от метода определения объекта.
    - `x`: Смещение по оси X (число).
    - `y`: Смещение по оси Y (число).
- `dimensions`: Размеры области для извлечения данных.
- `page_number`*: Номер страницы, на которой находится объект (целое число, начиная с `0`).

#### Пример:

```yaml
objects:
  - type: "text"
    name: "report_time"
    method: "absolute"
    offset:
      x: 520
      y: 20
    dimensions:
      width: 130
      height: 20
    page_number: 0
```

### 3. Описание объектов типа "text"

Текстовые объекты извлекаются из определенной области на странице PDF.

#### Поля для текстового объекта:

- `type`: `"text"`.
- `name`: Уникальное имя объекта.
- `method`: `"absolute"`.
- `offset`: Координаты верхнего левого угла области, из которой извлекается текст.
    - `x`: Смещение по оси X (число).
    - `y`: Смещение по оси Y (число).
- `dimensions`: Размеры области для извлечения текста.
    - `width`: Ширина области (число).
    - `height`: Высота области (число).
- `page_number`: Номер страницы, на которой находится объект (целое число, начиная с `0`).

#### Пример:

```yaml
- type: "text"
  name: "report_time" # Время отчёта
  method: "absolute"
  offset:
    x: 520
    y: 20
  dimensions:
    width: 130
    height: 20
  page_number: 0
```

### 4. Описание объектов типа "table"

Табличные объекты описываются более детально. В зависимости от метода определения объекта, таблица может считываться по
разному.

#### Поля для табличного объекта:

- `type`: `"table"`.
- `name`: Уникальное имя таблицы.
- `method`: Метод определения таблицы. Возможные значения:
    - `"by_pointers"`: Таблица определяется по указателям (например, рисунки).

#### 4.1 Метод `"by_pointers"`, поле `blocks_pointer`

Указатель на блоки таблицы, которые определяют начало каждой группы строк.
Под блоками понимаются области, в которых находятся данные таблицы и имеющие свой собственный заголовок.
В случае с лифтами, заголовок блока это только одна строка, содержащая название компании. Но в общем случае, заголовок
блока может быть более сложным, и конфигурация может обработать любое количество строк в заголовке блока.

#### Поля:

- `type`: `"drawing"` (тип указателя, например, рисунок).
- `criteria`: Критерии для поиска указателя. Возможные критерии:
    - `height`: Высота указателя (число).
    - `width`: Ширина указателя (число).
    - Можно добавить другие критерии в будущем, например, поиск по тексту или цвету.
- `multiple`: Возможность наличия нескольких указателей (логическое значение: `true` или `false`).
- `offset`: Смещение относительно найденного указателя.
    - `x`: Смещение по оси X (число).
    - `y`: Смещение по оси Y (число).
- `dimensions`: Размеры области для извлечения данных.
    - `width`: Ширина области (число).
    - `height`: Высота области (число).
- `headers`: Описание заголовков таблицы.
    - `names`: Список имен заголовков столбцов (массив строк), используется для извлечения данных и формирования
      результирующего датасета.
    - `column_widths`: Ширины столбцов (массив чисел).

#### Пример:

```yaml
blocks_pointer:
  type: "drawing"
  criteria:
    height: 3.0
  multiple: true
  offset:
    x: 0
    y: -17
  dimensions:
    width: 570
    height: 17
  headers:
    names: [ "company_name" ]
    column_widths: [ 570 ]
```

#### 4.2 `row_pointer`

Указатель на строки таблицы. Используется для определения и извлечения строк таблицы. Схож с указателем на блоки.

- `type`: `"drawing"` (тип указателя, например, рисунок).
- `criteria`: Критерии для поиска указателя. Возможные критерии:
    - `height`: Высота указателя (число).
    - `width`: Ширина указателя (число).
    - Можно добавить другие критерии в будущем, например, поиск по тексту или цвету.
- `multiple`: Возможность наличия нескольких указателей (логическое значение: `true` или `false`).
- `offset`: Смещение относительно найденного указателя.
    - `x`: Смещение по оси X (число).
    - `y`: Смещение по оси Y (число).
- `dimensions`: Размеры области для извлечения данных.
    - `width`: Ширина области (число).
    - `height`: Высота области (число).
- `headers`: Описание заголовков строк.
    - `names`: Список имен заголовков столбцов (массив строк).
    - `column_widths`: Ширины столбцов (массив чисел).

#### Пример:

```yaml
row_pointer:
  type: "drawing"
  criteria:
    height: 0.1
  multiple: true
  offset:
    x: -5
    y: -35
  dimensions:
    width: 340
    height: 35
  headers:
    names: [ "start_time", "end_time", "downtime_hours", "factory_number", "serial_number" ]
    column_widths: [ 95, 90, 43, 55, 57 ]
```

#### 4.3 `end_of_table_marker`

Маркер конца таблицы. Определяет, как следует обрабатывать конец таблицы.

- `type`: Тип маркера. Возможные значения:
    - `"none"`: Нет явного маркера конца таблицы. Таблица считается законченной, когда не найдено больше строк.

#### Пример:

```yaml
end_of_table_marker:
  type: "none"
```

### Пример полного конфигурационного файла

```yaml
pdf_structure:
  metadata:
    title: "Название отчёта"
    author: "Автор"
    creation_date: "Дата создания"
    subject: "Описание документа"
    hash_sum: "Хэш-сумма"

  objects:
    - type: "text"
      name: "report_time" # Время отчёта
      method: "absolute"
      offset:
        x: 520
        y: 20
      dimensions:
        width: 130
        height: 20
      page_number: 0

    - type: "table"
      name: "stoppages_data" # Данные о простоях в таблице
      method: "by_pointers"
      blocks_pointer:
        type: "drawing"
        criteria:
          height: 3.0
        multiple: true
        offset:
          x: 0
          y: -17
        dimensions:
          width: 570
          height: 17
        headers:
          names: [ "company_name" ]
          column_widths: [ 570 ]
      row_pointer:
        type: "drawing"
        criteria:
          height: 0.1
        multiple: true
        offset:
          x: -5
          y: -35
        dimensions:
          width: 340
          height: 35
        headers:
          names: [ "start_time", "end_time", "downtime_hours", "factory_number", "serial_number" ]
          column_widths: [ 95, 90, 43, 55, 57 ]
      end_of_table_marker:
        type: "none"
```